function eventpost_apply(c,a,b){if(jQuery("#geo_address").val()==""){jQuery("#geo_address").val(c)}jQuery("#geo_latitude").val(a);jQuery("#geo_longitude").val(b);jQuery("#eventaddress_result").html("")}function eventpost_numdate(b){var a=new RegExp("[-: T/]","g");if(b.replace){b=b.replace(a,"")}return parseInt(b)}function eventpost_getdate(a){d=jQuery("#"+a+"_date").val();h=jQuery("#"+a+"_hour").val();if(h=="0"){h="00"}m=jQuery("#"+a+"_minute").val();if(m=="0"){m="00"}return eventpost_numdate(d+""+h+""+m)}function eventpost_getdate_sql(a){return jQuery("#"+a+"_date").val()+" "+jQuery("#"+a+"_hour").val()+":"+jQuery("#"+a+"_minute").val()+" "}function eventpost_chkdate(){var b=eventpost_getdate(eventpost.META_START);var a=eventpost_getdate(eventpost.META_END);if(a==""||b>a){jQuery("#"+eventpost.META_END+"_date").val(jQuery("#"+eventpost.META_START+"_date").val());jQuery("#"+eventpost.META_END+"_hour").val(jQuery("#"+eventpost.META_START+"_hour").val());jQuery("#"+eventpost.META_END+"_minute").val(jQuery("#"+eventpost.META_START+"_minute").val());jQuery("#"+eventpost.META_END+"_date").parent().find(".human_date").html(jQuery("#"+eventpost.META_START+"_date").parent().find(".human_date").html())}}function eventpost_edit(){sctype=jQuery("#ep_sce_type").val();if(sctype=="list"){jQuery("#ep_sce_maponly").hide();jQuery("#ep_sce_listonly").show()}if(sctype=="map"){jQuery("#ep_sce_maponly").show();jQuery("#ep_sce_listonly").hide()}var a="[events_"+sctype;jQuery("#event_post_sc_edit input,#event_post_sc_edit select").each(function(){if(!jQuery(this).hasClass("event_post_sc_no_use")){var c=jQuery(this).parent().parent().parent().attr("class");var b=jQuery(this).data("att");var e=jQuery(this).val();if(b!=null&&e!=""&&(c=="all"||c==sctype)){a+=" "+b+'="'+e+'"'}}});a+="]";jQuery("#ep_sce_shortcode").html(a)}function eventpost_insertcontent(c){if(IEbof){switchEditors.go("content","html");document.post.content.value+=c;switchEditors.go("content","tinymce")}else{document.post.content.value+=c;if(document.all){value=c;document.getElementById("content_ifr").name="content_ifr";var b=document.getElementById("content_ifr").document.selection;if(tinyMCE.activeEditor.selection){tinyMCE.activeEditor.selection.setContent(c)}else{if(tinyMCE.activeEditor){tinyMCE.activeEditor.execCommand("mceInsertRawHTML",false,c)}else{if(b){var a=b.createRange();a.pasteHTML(value)}else{}}}}else{document.getElementById("content_ifr").name="content_ifr";if(document.content_ifr){document.content_ifr.document.execCommand("insertHTML",false,c)}else{if(document.getElementById("content_ifr").contentDocument){document.getElementById("content_ifr").contentDocument.execCommand("insertHTML",false,c)}else{if(tinyMCE.activeEditor.selection){tinyMCE.activeEditor.selection.setContent(c)}else{tinyMCE.activeEditor.execCommand("mceInsertRawHTML",false,c)}}}}}}jQuery(document).ready(function(){jQuery("#event_address_search").click(function(){jQuery("#eventaddress_result").html('<input type="search" id="event_address_search_txt"/><input type="button" id="event_address_search_bt" value="ok" class="button"/>');jQuery("#event_address_search_bt").click(function(){var b=jQuery("#event_address_search_txt").attr("value");console.log(b);var a={action:"EventPostGetLatLong",q:b};jQuery("#eventaddress_result").html(b+'<br/><img src="'+eventpost.imgpath+'loader.gif" alt="..."/>');jQuery.post(ajaxurl,a,function(e){var f="";for(var c in e){c=e[c];if(c.lat!=undefined&&c.lon!=undefined&&c.display_name!=undefined){f+="<p><a onclick='eventpost_apply(\""+c.display_name.replace("'","&apos;").replace('"',"&quot;")+'","'+c.lat+'","'+c.lon+"\")'>";if(c.icon!=undefined){f+='<img src="'+c.icon+'" alt="'+c.type+'"/>'}f+=c.display_name+"</a></p>"}}jQuery("#eventaddress_result").html(f)},"json")})});jQuery("#event_post_sc_edit input,#event_post_sc_edit select").change(function(){eventpost_edit()});jQuery("#ep_sce_submit").click(function(){eventpost_insertcontent(jQuery("#ep_sce_shortcode").html())});jQuery("#ep_sce_nball").click(function(){jQuery("#ep_sce_nb").val("-1");eventpost_edit()});jQuery("#ep_sce_shortcode").click(function(){jQuery(this).select()});eventpost_edit();eventpost_chkdate();if(jQuery.datepicker){jQuery(".input-date").datepicker({firstDay:1,changeYear:true,changeMonth:true,showMonthAfterYear:true,yearRange:"c-5:+5",buttonText:eventpost.date_choose,showOn:"both",dateFormat:"yy-mm-dd",autoSize:true}).change(function(){var a=jQuery(this).attr("id").replace("_date","");var b=jQuery("#"+a+"_date_human");if(jQuery(this).val()!=""){jQuery.post(ajaxurl,{action:"EventPostHumanDate",date:eventpost_getdate_sql(a)},function(c){b.html(c);eventpost_chkdate()})}})}jQuery(".select-date").change(function(){var a=jQuery(this).attr("id").replace("_minute","").replace("_hour","");var b=jQuery("#"+a+"_date_human");if(jQuery(this).val()!=""){jQuery.post(ajaxurl,{action:"EventPostHumanDate",date:eventpost_getdate_sql(a)},function(c){b.html(c);eventpost_chkdate()})}});if(jQuery("body").hasClass("widgets-php")){jQuery(".widget").each(function(){wid=jQuery(this).attr("id");if(wid.indexOf("eventpostmap")>-1){jQuery(this).addClass("eventpost_admin_widget eventpost_widget_map")}else{if(wid.indexOf("eventpostcal")>-1){jQuery(this).addClass("eventpost_admin_widget eventpost_widget_cal")}else{if(wid.indexOf("eventpost")>-1){jQuery(this).addClass("eventpost_admin_widget eventpost_widget_list")}}}})}});