function eventpost_apply(e,t,n){""==jQuery("#geo_address").val()&&jQuery("#geo_address").val(e),jQuery("#geo_latitude").val(t),jQuery("#geo_longitude").val(n),jQuery("#eventaddress_result").html("")}function eventpost_numdate(e){var t=new RegExp("[-: T/]","g");return e=e.replace(t,""),parseInt(e)}function eventpost_getdate(e){return eventpost_numdate(jQuery("#"+e+"_date").val()+jQuery("#"+e+"_hour").val()+jQuery("#"+e+"_minute").val())}function eventpost_getdate_sql(e){return jQuery("#"+e+"_date").val()+" "+jQuery("#"+e+"_hour").val()+":"+jQuery("#"+e+"_minute").val()+" "}function eventpost_chkdate(){var e=eventpost_getdate(eventpost.META_START),t=eventpost_getdate(eventpost.META_END);(""==t||e>t)&&(jQuery("#"+eventpost.META_END+"_date").val(jQuery("#"+eventpost.META_START+"_date").val()),jQuery("#"+eventpost.META_END+"_hour").val(jQuery("#"+eventpost.META_START+"_hour").val()),jQuery("#"+eventpost.META_END+"_minute").val(jQuery("#"+eventpost.META_START+"_minute").val()),jQuery("#"+eventpost.META_END+"_date").parent().find(".human_date").html(jQuery("#"+eventpost.META_START+"_date").parent().find(".human_date").html()))}function eventpost_edit(){sctype=jQuery("#ep_sce_type").val(),"list"==sctype&&(jQuery("#ep_sce_maponly").hide(),jQuery("#ep_sce_listonly").show()),"map"==sctype&&(jQuery("#ep_sce_maponly").show(),jQuery("#ep_sce_listonly").hide());var e="[events_"+sctype;jQuery("#event_post_sc_edit input,#event_post_sc_edit select").each(function(){if(!jQuery(this).hasClass("event_post_sc_no_use")){var t=jQuery(this).parent().parent().parent().attr("class"),n=jQuery(this).data("att"),a=jQuery(this).val();null==n||""==a||"all"!=t&&t!=sctype||(e+=" "+n+'="'+a+'"')}}),e+="]",jQuery("#ep_sce_shortcode").html(e)}function eventpost_insertcontent(e){if(IEbof)switchEditors.go("content","html"),document.post.content.value+=e,switchEditors.go("content","tinymce");else if(document.post.content.value+=e,document.all){value=e,document.getElementById("content_ifr").name="content_ifr";var t=document.getElementById("content_ifr").document.selection;if(tinyMCE.activeEditor.selection)tinyMCE.activeEditor.selection.setContent(e);else if(tinyMCE.activeEditor)tinyMCE.activeEditor.execCommand("mceInsertRawHTML",!1,e);else if(t){var n=t.createRange();n.pasteHTML(value)}}else document.getElementById("content_ifr").name="content_ifr",document.content_ifr?document.content_ifr.document.execCommand("insertHTML",!1,e):document.getElementById("content_ifr").contentDocument?document.getElementById("content_ifr").contentDocument.execCommand("insertHTML",!1,e):tinyMCE.activeEditor.selection?tinyMCE.activeEditor.selection.setContent(e):tinyMCE.activeEditor.execCommand("mceInsertRawHTML",!1,e)}jQuery(document).ready(function(){jQuery("#event_address_search").click(function(){jQuery("#eventaddress_result").html('<input type="search" id="event_address_search_txt"/><input type="button" id="event_address_search_bt" value="ok" class="button"/>'),jQuery("#event_address_search_bt").click(function(){var e=jQuery("#event_address_search_txt").attr("value");console.log(e);var t={action:"EventPostGetLatLong",q:e};jQuery("#eventaddress_result").html(e+'<br/><img src="'+eventpost.imgpath+'loader.gif" alt="..."/>'),jQuery.post(ajaxurl,t,function(e){var t="";for(var n in e)n=e[n],void 0!=n.lat&&void 0!=n.lon&&void 0!=n.display_name&&(t+="<p><a onclick='eventpost_apply(\""+n.display_name.replace("'","&apos;").replace('"',"&quot;")+'","'+n.lat+'","'+n.lon+"\")'>",void 0!=n.icon&&(t+='<img src="'+n.icon+'" alt="'+n.type+'"/>'),t+=n.display_name+"</a></p>");jQuery("#eventaddress_result").html(t)},"json")})}),jQuery("#event_post_sc_edit input,#event_post_sc_edit select").change(function(){eventpost_edit()}),jQuery("#ep_sce_submit").click(function(){eventpost_insertcontent(jQuery("#ep_sce_shortcode").html())}),jQuery("#ep_sce_nball").click(function(){jQuery("#ep_sce_nb").val("-1"),eventpost_edit()}),jQuery("#ep_sce_shortcode").click(function(){jQuery(this).select()}),eventpost_edit(),eventpost_chkdate(),jQuery.datepicker&&jQuery(".input-date").datepicker({firstDay:1,changeYear:!0,changeMonth:!0,showMonthAfterYear:!0,yearRange:"c-5:+5",buttonText:eventpost.date_choose,showOn:"both",dateFormat:"yy-mm-dd",autoSize:!0}).change(function(){var e=jQuery(this).attr("id").replace("_date",""),t=jQuery("#"+e+"_date_human");""!=jQuery(this).val()&&jQuery.post(ajaxurl,{action:"EventPostHumanDate",date:eventpost_getdate_sql(e)},function(e){t.html(e),eventpost_chkdate()})}),jQuery(".select-date").change(function(){var e=jQuery(this).attr("id").replace("_minute","").replace("_hour",""),t=jQuery("#"+e+"_date_human");""!=jQuery(this).val()&&jQuery.post(ajaxurl,{action:"EventPostHumanDate",date:eventpost_getdate_sql(e)},function(e){t.html(e),eventpost_chkdate()})}),jQuery("body").hasClass("widgets-php")&&jQuery(".widget").each(function(){wid=jQuery(this).attr("id"),wid.indexOf("eventpostmap")>-1?jQuery(this).addClass("eventpost_admin_widget eventpost_widget_map"):wid.indexOf("eventpostcal")>-1?jQuery(this).addClass("eventpost_admin_widget eventpost_widget_cal"):wid.indexOf("eventpost")>-1&&jQuery(this).addClass("eventpost_admin_widget eventpost_widget_list")})});