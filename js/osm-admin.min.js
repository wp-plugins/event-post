function eventpost_apply(c,a,b){if(jQuery("#geo_address").val()==""){jQuery("#geo_address").val(c)}jQuery("#geo_latitude").val(a);jQuery("#geo_longitude").val(b);jQuery("#eventaddress_result").html("")}function eventpost_numdate(b){var a=new RegExp("[-: T/]","g");if(b.replace){b=b.replace(a,"")}return parseInt(b)}function eventpost_getdate(a){d=jQuery("#"+a+"_date").val();return d?eventpost_numdate(d.substring(0,16)+":00"):""}function eventpost_getdate_sql(a){return jQuery("#"+a+"_date").val()}function eventpost_concat_time(){jQuery(".eventpost-datepicker-separate-wrap").each(function(){d=jQuery(this).find(".eventpost-datepicker-separate-date").val()+" "+jQuery(this).find(".eventpost-datepicker-separate-hour").val()+":"+jQuery(this).find(".eventpost-datepicker-separate-time").val()+":00";jQuery(this).find(".eventpost-datepicker-separate").val(d)})}function eventpost_chkdate(){var b=eventpost_getdate(eventpost.META_START);var a=eventpost_getdate(eventpost.META_END);console.log(b+" "+a);if(a===""||b>a){jQuery("#"+eventpost.META_END+"_date").val(jQuery("#"+eventpost.META_START+"_date").val());jQuery("#"+eventpost.META_END+"_date").parent().find(".human_date").html(jQuery("#"+eventpost.META_START+"_date").parent().find(".human_date").html());a=b}console.log(b);if(b===0){jQuery(".event-post-event_begin_date-remove").hide()}else{jQuery(".event-post-event_begin_date-remove").show()}if(a===0){jQuery(".event-post-event_end_date-remove").hide()}else{jQuery(".event-post-event_end_date-remove").show()}}function eventpost_edit(){sctype=jQuery("#ep_sce_type").val();if(sctype=="list"){jQuery("#ep_sce_maponly").hide();jQuery("#ep_sce_listonly").show()}if(sctype=="map"){jQuery("#ep_sce_maponly").show();jQuery("#ep_sce_listonly").hide()}var a="[events_"+sctype;jQuery("#event_post_sc_edit input,#event_post_sc_edit select").each(function(){if(!jQuery(this).hasClass("event_post_sc_no_use")){var c=jQuery(this).parent().parent().parent().attr("class");var b=jQuery(this).data("att");var e=jQuery(this).val();if(b!=null&&e!=""&&(c=="all"||c==sctype)){a+=" "+b+'="'+e+'"'}}});a+="]";jQuery("#ep_sce_shortcode").html(a)}function eventpost_insertcontent(c){if(IEbof){switchEditors.go("content","html");document.post.content.value+=c;switchEditors.go("content","tinymce")}else{document.post.content.value+=c;if(document.all){value=c;document.getElementById("content_ifr").name="content_ifr";var b=document.getElementById("content_ifr").document.selection;if(tinyMCE.activeEditor.selection){tinyMCE.activeEditor.selection.setContent(c)}else{if(tinyMCE.activeEditor){tinyMCE.activeEditor.execCommand("mceInsertRawHTML",false,c)}else{if(b){var a=b.createRange();a.pasteHTML(value)}else{}}}}else{document.getElementById("content_ifr").name="content_ifr";if(document.content_ifr){document.content_ifr.document.execCommand("insertHTML",false,c)}else{if(document.getElementById("content_ifr").contentDocument){document.getElementById("content_ifr").contentDocument.execCommand("insertHTML",false,c)}else{if(tinyMCE.activeEditor.selection){tinyMCE.activeEditor.selection.setContent(c)}else{tinyMCE.activeEditor.execCommand("mceInsertRawHTML",false,c)}}}}}}jQuery(document).ready(function(){jQuery("#event_address_search").click(function(){jQuery("#eventaddress_result").html('<input type="search" id="event_address_search_txt"/><input type="button" id="event_address_search_bt" value="ok" class="button"/>');jQuery("#event_address_search_bt").click(function(){var b=jQuery("#event_address_search_txt").attr("value");console.log(b);var a={action:"EventPostGetLatLong",q:b};jQuery("#eventaddress_result").html(b+'<br/><img src="'+eventpost.imgpath+'loader.gif" alt="..."/>');jQuery.post(ajaxurl,a,function(e){var f="";for(var c in e){c=e[c];if(c.lat!=undefined&&c.lon!=undefined&&c.display_name!=undefined){f+="<p><a onclick='eventpost_apply(\""+c.display_name.replace("'","&apos;").replace('"',"&quot;")+'","'+c.lat+'","'+c.lon+"\")'>";if(c.icon!=undefined){f+='<img src="'+c.icon+'" alt="'+c.type+'"/>'}f+=c.display_name+"</a></p>"}}jQuery("#eventaddress_result").html(f)},"json")})});jQuery("#event_post_sc_edit input,#event_post_sc_edit select").change(function(){eventpost_edit()});jQuery("#ep_sce_submit").click(function(){eventpost_insertcontent(jQuery("#ep_sce_shortcode").html())});jQuery("#ep_sce_nball").click(function(){jQuery("#ep_sce_nb").val("-1");eventpost_edit()});jQuery("#ep_sce_shortcode").click(function(){jQuery(this).select()});eventpost_edit();jQuery(".event-color-section p label:nth-child(n9)").wrapAll('<span id="event-color-section-more"/>');jQuery("#event-color-section-more").hide().before('<a id="event-color-section-more-btn">'+eventpost.more_icons+"</a>");jQuery("#event-color-section-more-btn").css({display:"block"}).click(function(){jQuery("#event-color-section-more").toggle(300)});eventpost_chkdate();jQuery(".eventpost-datepicker-dual").each(function(){var a={format:"Y-m-d H:i",lang:jQuery(this).data("lang"),step:15,value:jQuery(this).val(),onSelectDate:function(b,c){eventpost_chkdate()},onSelectTime:function(b,c){eventpost_chkdate()}};console.log(a);jQuery(this).datetimepicker(a)}).css({visibility:"hidden",height:"1px"}).change(function(){var a=jQuery(this).attr("id");var b=jQuery("#"+a+"_human");if(jQuery(this).val()!==""){jQuery.post(ajaxurl,{action:"EventPostHumanDate",date:jQuery(this).val()},function(c){b.html(c);eventpost_chkdate()})}});jQuery(".human_date").click(function(){var a=jQuery(this).attr("id").replace("_human","");jQuery("#"+a).datetimepicker("show")}).each(function(){var a=jQuery(this).attr("id").replace("_human","");jQuery(this).after('<a class="dashicons dashicons-trash eventpost-date-remove event-post-'+a+'-remove" data-id="'+a+'"/>')});jQuery(".eventpost-date-remove").click(function(){var a=jQuery(this).data("id");jQuery("#"+a).val("");jQuery("#"+a+"_human").text(eventpost.pick_a_date);eventpost_chkdate()});jQuery(".eventpost-datepicker-separate").each(function(){current_date=jQuery(this).val();current_id=jQuery(this).attr("id");jQuery(this).wrap('<span class="eventpost-datepicker-separate-wrap">');jQuery(this).after('<input class="eventpost-datepicker-separate-date" value="'+current_date.substr(0,10)+'" data-id="'+current_id+'"><select class="eventpost-datepicker-separate-hour" data-id="'+current_id+'"></select><select class="eventpost-datepicker-separate-time" data-id="'+current_id+'"></select>');jQuery(this).hide();for(h=0;h<24;h++){h0=h>9?h:"0"+h;h0h=h0;if(eventpost.lang==="en"){if(h<=12){h0h=h+" AM"}else{h0h=(h-12)+" PM"}}jQuery(".eventpost-datepicker-separate-hour").append('<option value="'+h0+'"'+(h===parseInt(current_date.substr(11,2))?" selected":"")+">"+h0h+"</option>")}m_sel=false;for(m=0;m<60;m+=15){m0=m>9?m:"0"+m;selected="";if(!m_sel&&Math.abs(m-parseInt(current_date.substr(14,2)))<=7){selected=" selected";m_sel=true}jQuery(".eventpost-datepicker-separate-time").append('<option value="'+m0+'"'+selected+">"+m0+"</option>")}});if(jQuery.datepicker){jQuery(".eventpost-datepicker-separate-date").datepicker({firstDay:1,changeYear:true,changeMonth:true,showMonthAfterYear:true,yearRange:"c-5:+5",buttonText:eventpost.date_choose,showOn:"both",dateFormat:"yy-mm-dd",autoSize:true}).change(function(){var a=jQuery(this).attr("id").replace("_date","");var b=jQuery("#"+a+"_date_human");if(jQuery(this).val()!=""){jQuery.post(ajaxurl,{action:"EventPostHumanDate",date:eventpost_getdate_sql(a)},function(c){b.html(c);eventpost_chkdate()})}})}jQuery(".eventpost-datepicker-separate-date, .eventpost-datepicker-separate-hour, .eventpost-datepicker-separate-time").change(function(){eventpost_concat_time();var a=jQuery(this).data("id").replace("_date","");var b=jQuery("#"+a+"_date_human");if(jQuery(this).val()!=""){jQuery.post(ajaxurl,{action:"EventPostHumanDate",date:eventpost_getdate_sql(a)},function(c){b.html(c);eventpost_chkdate()})}});if(jQuery("body").hasClass("widgets-php")){jQuery(".widget").each(function(){wid=jQuery(this).attr("id");if(wid.indexOf("eventpostmap")>-1){jQuery(this).addClass("eventpost_admin_widget eventpost_widget_map")}else{if(wid.indexOf("eventpostcal")>-1){jQuery(this).addClass("eventpost_admin_widget eventpost_widget_cal")}else{if(wid.indexOf("eventpost")>-1){jQuery(this).addClass("eventpost_admin_widget eventpost_widget_list")}}}})}});